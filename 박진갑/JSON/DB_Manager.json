Unload Req일때 Port의 bottle id 저장필요


============================================================================ 
file name   : DB_Manager.json
author      : JK Park
desc   
   1.    2024-06-01 최초생성
   2.    2024-06-19 bottle 1개씩 작업하는 것이 아니라 작업의뢰단위(Pack)에 따라 반송및 작업수행


관련 Token List

---------------------
101. 반출입기에서 공병Zone에 투입가능한 Bottle 수량요청              			ReqLoadingableHoleCapaAtEmptyBottleZoneFmDB
     --> 설비에서 대치가능. 실시간 상태확인 필요한 경우 (바람직한 방향)
	 --> UI 호출할때 사용
102. 반출입기에서 실병Zone에 Bottle 입고할 충분한 공간 있는지 확인을 위한 Empty hole수량요청  ReqLoadingableHoleCapaAtRealBottleZoneFmDB
     --> 설비에서 대치가능. 실시간 상태확인 필요한 경우 (바람직한 방향)
	 --> UI 호출할때 사용
103. 반출입기 설비상태를 요청한다.									ReqStatusOfInOutBotEqp
     --> 설비에서 대치가능. 실시간 상태확인 필요한 경우 (바람직한 방향)
	 --> UI 호출할때 사용
104. 반출입기에서 적정 빈병을 추출한다                   				ExtractSuitableEmptyBottleAtInOutBotEqp
105. 반출입기에서 적정 Real Bottle을 추출한다                     	ExtractSuitableRealBottleAtInOutBotEqp

111. 반출입기 U1(출하) Port에서 실병 입고요청(LoadReq)메세지         	RealBottleLoadReqAtWorkingArea
112. 반출입기 U1(출하) Port에서 실병 도착완료(LoadComp)메세지        	RealBottleLoadCompAtWorkingArea
113. 반출입기 U1(출하) Port에서 실병 출하요청(UnloadReq)메세지        	RealBottleUnloadReqAtWorkingArea
     --> 112, 113번 한개만 사용해도 가능할 수 있음. 검토필요
114. 반출입기에서 실병 출하완료메세지(#13 공정완료)                    	RealBottleTransferCompAtWorkingArea
115. 반출입기 L1(입고) Port에서 빈병 입고요청메세지                  	EmptyBottleLoadReqAtWorkingArea
116. 반출입기 L1(입고) Port에서 빈병 도착완료메세지(#11 공정시작)       	EmptyBottleLoadCompAtWorkingArea
117. 반출입기 L1(입고) Port에서 빈병 출하요청(UnloadReq)메세지       	EmptyBottleUnloadReqAtWorkingArea
     --> 116, 117번 한개만 사용해도 가능할 수 있음. 검토필요
118. 반출입기에서 빈병 입고완료메세지              					EmptyBottleTransferCompAtWorkingArea

121. 반출입기 L2(입고) Port에서 실병 입고요청(LoadReq)메세지            	RealBottleLoadReqAtOutArea
122. 반출입기 L2(입고) Port에서 실병 도착완료(LoadComp)메세지(#13 공정시작)	RealBottleLoadCompAtOutArea
123. 반출입기에서 실병 입고완료메세지              					RealBottleTransferCompAtOutArea
124. 반출입기 U2(출하) Port에서 빈병 입고요청(LoadReq)메세지          	EmptyBottleLoadReqAtOutArea
125. 반출입기 U2(출하) Port에서 빈병 도착완료(LoadComp)메세지			EmptyBottleLoadCompAtOutArea
126. 반출입기에서 빈병 출하완료메세지(#11 공정완료)						EmptyBottleTransferCompAtOutArea

131. 의뢰수량에 대한 일괄처리를 위한 MemberOfBottlePack Set       		SetMemberOfBottlePack
     --> json 별도정의하지 않고 #105번 sp 내부에서만 사용
132. 의뢰수량에 대한 일괄처리를 위한 MemberOfBottlePack Reset     		ResetMemberOfBottlePack
     --> json 별도정의하지 않고 #113번 sp 내부에서만 사용
133. 세팅된 실험의뢰정보를 가져온다									GetLaboratoryDemandInformation

---------------------
201. Stocker에서 hole capacity(Bottle 적재수량)               	GetBottleCapacityOfStocker 
     --> 설비에서 대치가능. 실시간 상태확인 필요한 경우 (바람직한 방향)
	 --> UI 호출할때 사용
202. Stocker에 bottle 적재할 충분한 공간이 있는지 확인한다           	CheckLoadingableHoleCapaAtStocker Or GetAdequateNumberOfSpareHolesAtStocker
     --> 설비에서 대치가능. 실시간 상태확인 필요한 경우 (바람직한 방향)
	 --> UI 호출할때 사용
203. Stocker 설비상태를 요청한다.									ReqStatusOfStocker
     --> 설비에서 대치가능. 실시간 상태확인 필요한 경우 (바람직한 방향)
	 --> UI 호출할때 사용
211. Stocker에 입고완료메세지(#21 공정시작)							LoadCompAtStocker
212. Stocker에 출하완료메세지(#21 공정완료)							UnoadCompAtStocker

---------------------
301. 분석기가 작업가능여부 사전 확인한다                            	CheckRunableStatusAtAnalyzer
302. 분석기 설비상태를 요청한다.									    ReqStatusOfAnalyzer
     --> 설비에서 대치가능. 실시간 상태확인 필요한 경우 (바람직한 방향)
	 --> UI 호출할때 사용
311. 분석기에 투입완료메세지(#31 공정시작)								LoadCompAtAnalyzer
312. 분석기에 출하완료메세지(#31 공정완료)								UnloadCompAtAnalyzer

---------------------
401. MOMA 작업가능여부 사전 확인한다                            		CheckRunableStatusAtMOMA
402  MOMA 장비상태를 reserve 변경                            		ChangeMOMA_Status2Reserve or ChangeEqpStatus2Reserve
403. MOMA 설비상태를 요청한다.									    ReqStatusOfMOMA
     --> 설비에서 대치가능. 실시간 상태확인 필요한 경우 (바람직한 방향)
	 --> UI 호출할때 사용
411. MOMA 이동시작메세지(#41 공정시작)								LoadCompAtMOMA
412. MOMA 이동완료메세지(#41 공정완료)								UnloadCompAtMOMA

--------------------- UI Or AIMS
501. 실험의뢰정보를 세팅한다 										SetLaboratoryDemandInformation

--------------------- 공통
901. 입고요청(LoadReq)                                      LoadRequest
902. 입고완료(착공-LoadComp)                                  LoadComp
903. 출하요청(UnloadReq)                                    UnloadRequest
904. 출하완료(완공-UnloadComp)                                UnloadComp
905. 장비반송 사전예약                                          ReserveEqpPort4Dispatch
906. Process상태변경                                        ChangeProcessStatus
907. 장비상태변경                                             ChangeEqpStatus
908. 특정장비(분석기,stocker)상태요청                            ReqAnalysisEqpStatus
909. 모든 장비상태요청                                          ReqAllEqpStatus
910. Bottle정보 수동변겅                                      ChangeBottleStatus
911. 반출입기에서 공 Bottle 수량요청                              GetCountEmptyBottleAtInOutBottle
912. 설비내 Bottle 정보요청                                    ReqBottleInfoFmEqp
913. 모든 Bottle 정보요청                                     ReqAllBottlesInfo
914. 작업대기중인 Bottle 정보요청                                 InputWaitingBottleInfoFmEqp
915. Bottle 공정이력정보 요청                                   Req4BottleProcessHistory
916. stocker내에 반송우선순위 bottle 확인                         CheckTopPriorityBottle
917. 반송Event 있는지 확인                                     CheckTransferEvent
//16. 공 Bottle 반출지시                                     OutEmptyBottle
suitable bottle

Normal Sequence Flow
1-1 Bottle반출입기(신규)    '공 Bottle 반출요청'수신                                 UI Or LIMS에서 요청
    1) 사전에 출하가능한지 확인. 즉 요청한 수량을 출하하기 위한 충분한 수량 있는지 확인
       (1) Bottle 반출입기에서 공병Zone에 Bottle 수량요청 (#101)
       (2) 요청수량과 공병수량 비교판단후 반출입기 컨트롤러에서 수량저장
    2) 출하가능하면 아래수행, 불가능하면 지정시간 sleep후 재호출. 지정 최대대기시간 초과하면 alarm.
    3) Bottle반출입기 Controller에서 반출입기 설비에 적정 Empty Bottle 출하지시 (#105)
    4) 요청한 Bottle Unload-2 Port에 도착후 작업자가 끄집어내면 LoadReq (#901)          분석실 외부공간쪽 반출입기 Unload Port에 공 Bottle 반출 (반출입기 작업자공간쪽 Port에서, OperID=1)
    5) Unload-2 Port에서 LoadReq 수신후 작업자 요청수량내에서 3)번 호출 반복
1-2 작업자                                                                     시료채취
1-3 작업자                입고완료(착공-LoadComp)                                분석실 외부공간쪽 반출입기 Load Port 실 Bottle 최초투입(OperID=3)
1-4 Bottle반출입기          실병Zone hole에서 투입대기                                  분석실 외부공간쪽 반출입기 Load Port 실 Bottle 최초투입(OperID=3)
1-5 Bottle반출입기         Unload_1 Port에서 입고요청(LoadReq)                        분석실 내부공간쪽 반출입기 Unload Port 실 Bottle Load요청 (반출입기 실험실공간쪽 Unload Port에서, OperID=4)
    1) 사전에 반송가능한지 확인. 즉 분석기에서 작업가능한지, Stocker에 공간이 충분한지 확인한다
       (1) 분석기가 작업가능여부 사전 확인한다 (#301)
       (2) Stocker에 bottle 적재할 충분한 공간이 있는지 확인한다 (#202)
       (3) MOMA 작업가능한 상태인지 확인한다. (#401)
    2) 반송가능하면 아래수행, 불가능하면 지정시간 sleep후 재호출. 지정 최대대기시간 초과하면 alarm.
    3) MOMA에게 반출입기 Unload Port_1 위치로 이동지시
	   - MOMA에서 token 정의
    4) 사전에 Bottle반출입기에서 MOMA로 bottle 이동 가능한지 확인.
       - MOMA unload_1 port도착했는지 확인
    5) 이동가능햐면 아래수행, 불가능하면 지정시간 sleep후 재호출. 지정 최대대기시간 초과하면 alarm.
	6) MOMA 상태를 reserve로 변경 (#402)
    7) 반출입기 설비에 적정 Real Bottle 추출지시 (#106)
       - 나머지 의뢰수량(Pack수량) 일괄처리 인출을 위하여 MemberOfBottlePack field값을 set한다.
       - 의뢰수량에 대한 일괄처리를 위한 MemberOfBottlePack Set (#107)
    8) 요청한 Bottle Unload-1 Port에 도착후                                        분석실 외부공간쪽 반출입기 Unload Port에 공 Bottle 반출 (반출입기 작업자공간쪽 Port에서, OperID=1)
    9) Bottle반출입기에서 MOMA로 bottle 이동   
	   - MOMA에서 token 정의
       - unload comp후 의뢰수량에 대한 일괄처리를 위한 MemberOfBottlePack Reset (#108)
   10) Unload-1 Port에서 LoadReq 수신후 Pack 수량만큼 6)번 호출 반복
1-6 Bottle반출입기         출하완료(완공-UnloadComp)
1-7 Bottle반출입기         입고완료(착공-LoadComp)                                분석실 내부공간쪽 반출입기 Load Port에 세정후 재사용을 위하여 공 Bottle 투입(OperID=5, /w BottleID)
1-8 Bottle반출입기         입고요청(LoadReq)                                    분석실 내부공간쪽 반출입기 Load Port에서

2-1 Stocker             입고완료(착공-LoadComp)                                   Stocker 위치정보보고
2-2 Stocker(신규)         출하지시수신                                              Dispatcher가 우선순위에 따라 Stocker내 Bottle에 대한 출하요청
2-3 Stocker             출하완료(완공-UnloadComp)

3-1 분석기                 입고완료(착공-LoadComp)       
3-2 분석기                 장비상태변경(분석시작)                                Idle --> Run  Waiting 추가
3-3 분석기                                                             분석작업       
3-4 분석기                 장비상태변경(분석종료)                                Run --> Idle
3-5 분석기                 출하완료(완공-UnloadComp)

4-1 이동형협업로봇(신규)         LoadComp                  설비에서 MOMA에 Bottle 적재한 경우
4-1 이동형협업로봇(신규)         GripBottle                Gripper가 Bottle 잡은경우, UI화면에 동작표시
4-2 이동형협업로봇(신규)         MovingBottle              이동중
4-3 이동형협업로봇(신규)         UnloadComp                Gripper가 Bottle 내려놓은 경우. 즉 MOMA에서 설비에 Bottle 옮긴경우

============================================================================ 

101. Bottle 반출입기에서 공병Zone에 투입가능한 Bottle 수량요청
   1) Token : ReqLoadingableHoleCapaAtEmptyBottleZoneFmDB
   2) 관련 controller : AIMS Controller, UI
   3) Body
      { 
         none
      }      
   4) Function : Bottle 반출입기에서 빈병을 출하하기전에 요청수량 빈병이 있는지 확인한다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "HoleTotCountInEmptyBottleZone" : 5
         "error_msg" : "None"
      }      

102. Bottle 반출입기에서 실병Zone에 Bottle 입고할 충분한 공간 있는지 확인을 위한 Empty hole수량요청
   1) Token : ReqLoadingableHoleCapaAtRealBottleZoneFmDB
   2) 관련 controller : AIMS Controller, UI
   3) Body
      { 
         none
      }      
   4) Function : Bottle 반출입기에서 실병을 입고하기전에 실병Pack 수량 입고할 충분한 hole 있는지 확인한다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "HoleTotCountInRealBottleZone" : 5
         "error_msg" : "None"
      }      

103. 반출입기 장비상태요청
   1) Token : ReqStatusOfInOutBotEqp
   2) 관련 controller : Dispatch,
                      UI
   3) Body
      { 
         None
      }      
   4) Function : tMstEqp table의 반출입기 EqpStatus(장비상태) 요청
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : RetrieveStatuseOfInOutBotEqp
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "eqp_status" : "Run",
         "error_msg" : "None"
      } 
	  
104. 반출입기에서 적정 빈병을 추출한다
   1) Token : ExtractSuitableEmptyBottleAtInOutBotEqp
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         none
      }      
   4) Function : Bottle 반출입기 빈병Zone에서 빈병Pack 수량 만큼 출고한다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "TotCountOfEmptyBottlePack" : 5
         "EmptyBottleInfo" : [
            { "BottleID_1" : "ID_001"
            },
            { "BottleID_2" : "ID_002"
            },
            ...
            { "BottleID_5" : "ID_005"
            }
         ],		 
         "error_msg" : "None"
      }   
	  
105. 반출입기에서 적정 Real Bottle을 추출한다
   1) Token : ExtractSuitableRealBottleAtInOutBotEqp
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         none
      }      
   4) Function : Bottle 반출입기 실병Zone에서 실병Pack 수량 만큼 출고한다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "TotCountOfRealBottlePack" : 5
         "RealBottleInfo" : [
            { "BottleID_1" : "ID_001"
            },
            { "BottleID_2" : "ID_002"
            },
            ...
            { "BottleID_5" : "ID_005"
            }
         ],		 
         "error_msg" : "None"
      }   	  
	  
111. 반출입기 U1(출하) Port에서 실병 입고요청(LoadReq)메세지
   1) Token : RealBottleLoadReqAtWorkingArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         none
      }      
   4) Function : 반출입기 U1 Port에 실병없을때(비어있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }      

112. 반출입기 U1(출하) Port에서 실병 도착완료(LoadComp)메세지
   1) Token : RealBottleLoadCompAtWorkingArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : 반출입기 U1 Port에 실병도착했을때(병 있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

113. 반출입기 U1(출하) Port에서 실병 출하요청(UnloadReq)메세지
   1) Token : RealBottleUnloadReqAtWorkingArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : 반출입기 U1 Port에 실병도착했을때(병 있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

114. 반출입기에서 실병 출하완료메세지(#13 공정완료) 
   1) Token : RealBottleTransferCompAtWorkingArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : 반출입기 U1 Port에 있는 실병을 MOMA 이동했을때 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

115. 반출입기 L1(입고) Port에서 빈병 입고요청메세지
   1) Token : EmptyBottleLoadReqAtWorkingArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         none
      }      
   4) Function : 반출입기 U1 Port에 빈병없을때(비어있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }      

116. 반출입기 L1(입고) Port에서 빈병 도착완료메세지(#11 공정시작)
   1) Token : EmptyBottleLoadCompAtWorkingArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : 반출입기 U1 Port에 빈병도착했을때(병 있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

117. 반출입기 L1(입고) Port에서 빈병 출하요청(UnloadReq)메세지
   1) Token : EmptyBottleUnloadReqAtWorkingArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : 반출입기 U1 Port에 빈병도착했을때(병 있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }
	  
118. 반출입기에서 빈병 입고완료메세지
   1) Token : EmptyBottleTransferCompAtWorkingArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001",
		 "Position" : "2111"
      }      
   4) Function : 반출입기 빈병Area hole에 bottle을 투입완료했을때 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

121. 반출입기 L2(입고) Port에서 실병 입고요청(LoadReq)메세지
   1) Token : RealBottleLoadReqAtOutArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         none
      }      
   4) Function : 반출입기 L2 Port에 실병없을때(비어있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }      

122. 반출입기 L2(입고) Port에서 실병 도착완료(LoadComp)메세지(#13 공정시작)
   1) Token : RealBottleLoadCompAtOutArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : 반출입기 L2 Port에 실병도착했을때(병 있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

123. 반출입기에서 실병 입고완료메세지
   1) Token : RealBottleTransferCompAtOutArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001",
		 "Position" : "1111"
      }      
   4) Function : 반출입기 실병Area hole에 bottle을 투입완료했을때 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

124. 반출입기 U2(출하) Port에서 빈병 입고요청(LoadReq)메세지
   1) Token : EmptyBottleLoadReqAtOutArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         none
      }      
   4) Function : 반출입기 U2 Port에 빈병없을때(비어있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }      

125. 반출입기 U2(출하) Port에서 빈병 도착완료(LoadComp)메세지
   1) Token : EmptyBottleLoadCompAtOutArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : 반출입기 U2 Port에 빈병도착했을때(병 있을때) 요청하는 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

126. 반출입기에서 빈병 출하완료메세지(#11 공정완료)
   1) Token : EmptyBottleTransferCompAtOutArea
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : 반출입기 U2 Port에 있는 빈병을 작업자가 끄집어낼때 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

133. 세팅된 실험의뢰정보를 가져온다
   1) Token : GetLaboratoryDemandInformation
   2) 관련 controller : 반출입기 Controller, UI
   3) Body
      { 
         "UserID" : "UID_KIM_001",
		 "ProjectNo" : "Prj_001"
      }      
   4) Function : 빈병을 추출하기 위하여 설비에서 작업자가 Login 할때 Event.
                 저장된 실험의뢰자의 실험요청정보를 가져온다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectLaboratoryDemandInformation
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "BottleDemandTotCount" : 5,
         "BottleDemands" : [
            { "No_1" : {
                 "BottleSeqNoOfDemand" : 1, "LiquidCharacter" : "Acid", "CollectionPosition":"합착기"}
            },
            { "No_2" : {
                 "BottleSeqNoOfDemand" : 2, "LiquidCharacter" : "Base", "CollectionPosition":"Macro"}
            },
            ...
            { "No_5" : {
                 "BottleSeqNoOfDemand" : 5, "LiquidCharacter" : "Organic", "CollectionPosition":"Pattern"}
            }
         ],		 
         "DemandTime" : "2024-06-22 21:29:10"		 
         "error_msg" : "None"
      } 


201. Stocker에서 hole capacity(Bottle Total 적재수량)
   1) Token : GetBottleCapacityOfStocker
   2) 관련 controller : 반출입기 Controller, Dispatcher
   3) Body
      { 
         none
      }      
   4) Function : Bottle 반출입기에서 빈병을 출하하기전에 요청수량 빈병이 있는지 확인한다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "BottleCapacityOfStocker" : 96
         "error_msg" : "None"
      }      

202. Stocker에 bottle 적재할 충분한 공간이 있는지 확인한다
   1) Token : CheckLoadingableHoleCapaAtStocker
   2) 관련 controller : 반출입기 Controller, Dispatcher, UI
   3) Body
      { 
         none
      }      
   4) Function : Bottle 반출입기에서 실병을 입고하기전에 실병Pack 수량 입고할 충분한 hole 있는지 확인한다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "LoadingableHoleCapa" : 5
         "error_msg" : "None"
      }      

203. Stocker 설비상태를 요청한다.
   1) Token : ReqStatusOfStocker
   2) 관련 controller : 반출입기 Controller, Dispatcher, UI
   3) Body
      { 
         None
      }      
   4) Function : tMstEqp table의 Stocker EqpStatus(장비상태) 요청
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : RetrieveStatuseOfInOutBotEqp
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "eqp_status" : "Run",
         "error_msg" : "None"
      } 

211. Stocker에 입고완료메세지(#21 공정시작)
   1) Token : LoadCompAtStocker
   2) 관련 controller : Stocker Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001",
		 "Position" : "2111"
      }      
   4) Function : Stocker Empty hole에 실병을 투입완료했을때 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      }  

212. Stocker에 출하완료메세지(#21 공정완료)
   1) Token : UnoadCompAtStocker
   2) 관련 controller : Stocker Controller, UI
   3) Body
      { 
         "BottleID" : "ID_001"
      }      
   4) Function : Stocker에서 실병을 인출했을때 Event message
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : SelectProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 
         "error_msg" : "None"
      } 



	  

501. 실험의뢰정보를 세팅한다
   1) Token : SetProcLaboratoryDemand
   2) 관련 controller : DBMgr
   3) Body
      { 
         "UserID" : "1",
         "ProjectNo" : "Prt 001",
         "BottleDemandTotCount" : 5,
         "BottleDemands" : [
            { "No_1" : {
                 "BottleSeqNoOfDemand" : 1, "LiquidCharacter" : "Acid", "CollectionPosition":"합착기"}
            },
            { "No_2" : {
                 "BottleSeqNoOfDemand" : 2, "LiquidCharacter" : "Base", "CollectionPosition":"Macro"}
            },
            ...
            { "No_5" : {
                 "BottleSeqNoOfDemand" : 5, "LiquidCharacter" : "Organic", "CollectionPosition":"Pattern"}
            }
         ],		 
         "DemandTime" : "2024-06-22 21:29:10"
      }      
   4) Function : 실험의뢰자의 실험요청정보를 저장
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : InsertProcLaboratoryDemand
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "AIMS Controller",    // DB_Manager		 		
         "error_msg" : "None"
      }      


901. 입고요청(LoadReq)
   1) Token : LoadRequest
   2) 관련 controller : Bottle 반출입기, 분석기, Stocker, 폐기설비
                      UI에서 수동변경
   3) Body
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1"
      } Or
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "ProcessStatus" : "LoadReq"
      }      
   4) Function : tMstEqp table의 ProcessStatus(진행상태) 변경
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : UpdateEqpProcessStatus
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기
         "error_msg" : "None"
      }      

902. 입고완료(착공-LoadComp)
   1) Token : LoadComp
   2) 관련 controller : Bottle 반출입기, 분석기, Stocker, 폐기설비
                      UI에서 수동변경
   3) Body
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "OperID" : "3",
         "BottleID" : "Bot20240602"
      } Or 
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "BottleID" : "Bot20240602",
         "ProcessStatus" : "LoadComp"
      }      
   4) Function : tMstEqp table의 ProcessStatus(진행상태) 변경
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : ProcessLoadUnloadCompletion
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "error_msg" : "None"
      }  

903. 출하요청(UnloadReq)
   1) Token : UnloadRequest
   2) 관련 controller : Bottle 반출입기, 분석기, Stocker, 폐기설비
                      UI에서 수동변경
   3) Body
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "BottleID" : "Bot20240602"
      } Or 
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "BottleID" : "Bot20240602",
         "ProcessStatus" : "UnloadReq"
      }      
   4) Function : tMstEqp table의 ProcessStatus(진행상태) 변경
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : UpdateEqpProcessStatus
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "error_msg" : "None"
      }      

904. 출하완료(착공-UnloadComp)
   1) Token : UnloadComp
   2) 관련 controller : Bottle 반출입기, 분석기, Stocker, 폐기설비
                      UI에서 수동변경
   3) Body
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "OperID" : "1",
         "BottleID" : "Bot20240602"
      } Or 
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "BottleID" : "Bot20240602",
         "ProcessStatus" : "UnloadComp"
      }      
   4) Function : tMstEqp table의 ProcessStatus(진행상태) 변경
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : ProcessLoadUnloadCompletion
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "error_msg" : "None"
      } 


905. 장비반송 사전예약, 다른 Process에서 해당장비 반송을 못하도록 하기 위함
   Dispatcher에서 To Position 정해지면 To Position을 Reserve한다.
   1) Token : ReserveEqpPort4Dispatch
   2) 관련 controller : Dispatcher
                      UI에서 수동변경
   3) Body
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1"
      } Or 
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "ProcessStatus" : "Reserve"       -- Next Eqp 상태를 Reserver 변경함
      }      
   4) Function : tMstEqp table의 ProcessStatus(진행상태)를 변경
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : UpdateEqpProcessStatus
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "error_msg" : "None"
      } 

906. Process상태변경
   LoadRequest, LoadComp, UnloadRequest, UnloadComp 통합하는 것도 가능
   1) Token : ChangeProcessStatus
   2) 관련 controller : Bottle 반출입기, 분석기, Stocker, 폐기설비
                      UI에서 수동변경     
   3-2) Body 
      { 
         "EqpGroupID" : "2",
         "EqpSeqNo" : "1",
         "BottleID" : "Bot20240602",
         "EqpStatus" : "Run" 
      }    
   4) Function : tMstEqp table의 EqpStatus(장비상태) 변경
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : 
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "error_msg" : "None"
      } 
      
907. 장비상태변경
   1) Token : ChangeEqpStatus
   2) 관련 controller : Bottle 반출입기, 분석기, Stocker, 폐기설비
                      UI에서 수동변경     
   3-2) Body 
      { 
         "EqpGroupID" : "2",
         "EqpSeqNo" : "1",
         "EqpStatus" : "Run" 
      }    
   4) Function : tMstEqp table의 EqpStatus(장비상태) 변경
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : UpdateEqpStatus
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "error_msg" : "None"
      }      
      
908. 특정장비(분석기)상태요청
   1) Token : ReqAnalysisEqpStatus
   2) 관련 controller : Dispatch,
                      UI
   3) Body
      { 
         "EqpGroupID" : "2",
         "EqpSeqNo" : "1",
      }      
   4) Function : tMstEqp table의 EqpStatus(장비상태) 요청
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : RetrieveEquipmentStatus
   7) Return
      { 
         "status_code" : 200,                   -- 요청에 대한 응답이 정상일때, 비정일때는 200 이외 수치
         "sender_controller" : "DB_Manager",    -- 고정
         "eqp_status" : "Run",
         "process_status" : "UnloadReq",
         "error_msg" : "None"
      } 
909. 장비상태요청
   1) Token : ReqAllEqpStatus
   2) 관련 controller : Dispatch,
                      UI
   3) Body
      { 
         None
      }      
   4) Function : tMstEqp table의 모든 EqpStatus(장비상태) 요청
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : RetrieveAllEquipmentStatuses
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",
         "total_cnt_of_eqp" : 5,
         "eqp_status" : [
            { "No_1" : {
                 "EqpGroupID" : "1", "EqpSeqNo" : "1", "ProcessStatus":"UnloadReq", "EqpStatus" : "Idle"}
            },
            { "No_2" : {
                 "EqpGroupID" : "2", "EqpSeqNo" : "1", "ProcessStatus":"Idle","EqpStatus" : "Run"}
            },
            ...
            { "No_5" : {
                 "EqpGroupID" : "5", "EqpSeqNo" : "1", "ProcessStatus":"LoadComp","EqpStatus" : "Idle"}
            }
         ],
         "error_msg" : "None"
      } 
      

910. Bottle정보 수동변겅
   1) Token : ChangeBottleStatus
   2) 관련 controller : UI
   3) Body
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "OperID" : "1"
         "NextEqpGroupID" : "1",
         "NextOperID" : "1"
      } 
   4) Function : UI화면에서 수동으로 tProcBottle table 공정정보를 변경할때 사용
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : UpdateBottleStatus
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기     
         "error_msg" : "None"
      }  
      
911. 반출입기에서 공 Bottle 수량요청   
    반출입기에서 출하할 공 Bottle 있는지 확인한다
   1) Token : GetCountEmptyBottleAtInOutBottle
   2) 관련 controller : UI
   3) Body
      {
         "CurrEqpGroupID" : "1",
         "CurrEqpSeqNo" : "1"         
      } 
   4) Function : tProcBottle table의 CurrEqpGroupID=1, CurrOperID=1인 Bottle 수량을 구한다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : RetrieveEmptyBottleCount
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기
         "total_cnt_of_empty_bottle" : 10,      // record 수량
         "error_msg" : "None"
      } 
      
912. 설비내 Bottle 정보요청
    UI화면에서 반출입기 설비에 추출가능한 빈병정보를 확인한다.
   1) Token : ReqBottleInfoFmEqp
   2) 관련 controller : Dispatch,
                      UI
   3) Body
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1"
      } 
   4) Function : tProcBottle table의 BottleID, EqpStatus, ProcessStatus... 가져온다
   5) Return Message 길이 : 1K 이상, 길이 제한에 따른 호출 불가할 경우 Controller에 sp 직접 호출필요
   6) 관련 Stored Procedure : FetchBottleStatusFmEquipment
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기
         "total_cnt_of_eqp" : 70,
         "eqp_status" : [
            { "No_1" : {
                 "BottleID" : "Bot_001", "ExperimentRequestName" : "홍길동", "CurrLiquid":"Acid", "RequestDate" : "2024-06-05", "DispatchingPriority":1, "Position":"0110", "EventTime" : "2024-06-05"}
            },
            { "No_2" : {
                 "BottleID" : "Bot_002", "ExperimentRequestName" : "심봉사", "ProcessStatus":"Base","RequestDate" : "2024-06-06", "DispatchingPriority":9, "Position":"0001", "EventTime" : "2024-06-05"}
            },
            ...
            { "No_70" : {
                 "BottleID" : "Bot_070", "ExperimentRequestName" : "이몽룡", "ProcessStatus":"Organic","RequestDate" : "2024-06-07", "DispatchingPriority":5, "Position":"0105", "EventTime" : "2024-06-05"}
            }
         ],      
         "error_msg" : "None"
      } 
      
913. 모든 Bottle 정보요청
   1) Token : ReqAllBottlesInfo
   2) 관련 controller : Dispatch,
                      UI
   3) Body
      { 
         None
      } 
   4) Function : tProcBottle table의 BottleID, EqpStatus, ProcessStatus... 가져온다
   5) Return Message 길이 : 1K 이상, 길이 제한에 따른 호출 불가할 경우 Controller에 sp 직접 호출필요
   6) 관련 Stored Procedure : RetrieveAllBottleStatuses
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기
         "total_cnt_of_eqp" : 300,
         "eqp_status" : [
            { "No_1" : {
                 "EqpGroupID" : "1", "EqpSeqNo" : "1", "BottleID" : "Bot_001", "ExperimentRequestName" : "홍길동", "CurrLiquid":"Acid", "RequestDate" : "2024-06-05", "DispatchingPriority":1, "Position":"0110", "EventTime" : "2024-06-05"}
            },
            { "No_2" : {
                 "EqpGroupID" : "2", "EqpSeqNo" : "1", "BottleID" : "Bot_002", "ExperimentRequestName" : "심봉사", "ProcessStatus":"Base","RequestDate" : "2024-06-06", "DispatchingPriority":9, "Position":"0001", "EventTime" : "2024-06-05"}
            },
            ...
            { "No_300" : {
                 "EqpGroupID" : "3", "EqpSeqNo" : "1", "BottleID" : "Bot_090", "ExperimentRequestName" : "이몽룡", "ProcessStatus":"Organic","RequestDate" : "2024-06-07", "DispatchingPriority":5, "Position":"0105", "EventTime" : "2024-06-05"}
            }
         ],      
         "error_msg" : "None"
      } 
      
914. 작업대기중인 Bottle 정보요청. 분석기에서 의미 있음
    UI화면 분석기 설비 모니터링 화면에 분석기 투입대기중인 수량과 관련정보 표시(즉, 반출입기 Or Stocker에서 Next 공정이 분석기인 경우) 
   1) Token : InputWaitingBottleInfoFmEqp
   2) 관련 controller : UI
   3) Body
      { 
         "NextEqpGroupID" : "2",
         "NextOperID" : "1"
      } 
   4) Function : tProcBottle table의 NextEqpGroupID의 BottleID, EqpStatus, ProcessStatus... 가져온다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : RetrievePendingBottles
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기
         "total_cnt_of_eqp" : 5,
         "eqp_status" : [
            { "No_1" : {
                 "BottleID" : "Bot_001", "ExperimentRequestName" : "홍길동", "CurrLiquid":"Acid", "RequestDate" : "2024-06-05", "DispatchingPriority":1, "Position":"0110", "EventTime" : "2024-06-05"}
            },
            { "No_2" : {
                 "BottleID" : "Bot_002", "ExperimentRequestName" : "심봉사", "ProcessStatus":"Base","RequestDate" : "2024-06-06", "DispatchingPriority":9, "Position":"0001", "EventTime" : "2024-06-05"}
            },
            ...
            { "No_5" : {
                 "BottleID" : "Bot_090", "ExperimentRequestName" : "이몽룡", "ProcessStatus":"Organic","RequestDate" : "2024-06-07", "DispatchingPriority":5, "Position":"0105", "EventTime" : "2024-06-05"}
            }
         ],      
         "error_msg" : "None"
      } 


915. Bottle 공정이력정보 요청        
   1) Token : Req4BottleProcessHistory
   2) 관련 controller : UI
   3) Body
      {
         "BottleID" : "Bot_001"
      } 
   4) Function : tProcBottle table의 CurrEqpGroupID=1, CurrOperID=1인 Bottle 수량을 구한다
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : FetchBottleProcessHistory
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기
         "total_cnt_of_process" : 5,            // record 수량
         "process_of_bottle" : [
            { "No_1" : {
                 "EqpGroupID" : "1", "OperID" : "2", "StartTime" : "2024-06-05", "EndTime" : "2024-06-05", "DispatchingPriority":1, "Position":"0110"}
            },
            { "No_2" : {
                 "EqpGroupID" : "2", "OperID" : "1", "StartTime" : "2024-06-06", "EndTime" : "2024-06-05", "DispatchingPriority":9, "Position":"0001"}
            },
            ...
            { "No_5" : {
                 "EqpGroupID" : "5", "OperID" : "1", "StartTime" : "2024-06-07", "EndTime" : "2024-06-05", "DispatchingPriority":5, "Position":"0105"}
            }
         ],          "error_msg" : "None"
      } 

916. stocker내에 반송우선순위 bottle 확인
   1) Token : CheckTopPriorityBottle
   2) 관련 controller : Dispatch
   3) Body
      { 
         "CurrEqpGroupID" : "3",
         "CurrEqpSeqNo" : "1",
         "NextEqpGroupID" : "3,
         "NextEqpSeqNo" : "1"
      } 
   4) Function : stocker내에 반송우선 bottle(기준 5) 있는지 확인하고, 
        stocker내에 bottle 우선순위, 입고순서로 sotting하여 해당 bottle 정보 출력
      반송우선절차 (ex:bottle 반출입기에서 unload request 발생시)
         (1) 분석기 장비상태가 idle인지 확인
             if idle 
                if stocker내에 작업우선순위 bottle 있는 경우는 bottle을 stocker에 입고
                else (즉, unload request 요청한 bottle의 우선순위가 높은경우) 분석기로 바로 이동
             if run
                분석기로 바로 이동
                지 확인하고 우선순위 bottle 있을때는 stocker에 입고
         (2) stocker Load port 상태가 "LoadReq"인지 확인
             if LoadReq 
                stocker 이동
             else (ex:Reserve)
                event driven 방식일때 event queue등에 저장후 event 재귀호출등
                time polling 병행일때 next time에 다시 수행       
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : GetTopPriorityBottle
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기   
         "top_priority_of_bottle" : 9,
         "bottle_id" : "bot_001"      
      }

917. 공 Bottle 반출지시 ?
   1) Token : OutEmptyBottle
   2) 관련 controller : Dispatch,
                      UI
   3) Body
      { 
         "EqpGroupID" : "1",
         "EqpSeqNo" : "1",
         "OperID" : "1"
      } 
   4) Function : 공정진행(완공)에 따라 tProcBottle table Bottle 정보를 Next 공정으로 변경한다.
                 tProcBotOper 공정진행정보 record 추가 생성한다.
   5) Return Message 길이 : 1K 이내
   6) 관련 Stored Procedure : 
   7) Return
      { 
         "status_code" : 200,
         "sender_controller" : "DB_Manager",    // 반출입기, Dispatcher, 분석기     
         "error_msg" : "None"
      } 


